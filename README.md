## Pipeline Overview
MATLAB (network + inputs)
        -->
C / MEX (dynamics + spikes)
        -->
.mat spike time series
        -->
Python (rates + modulation indices + figures)        

## Repository Structure
neuro_network_model/
## Repository Structure

```
neuro_network_model/
├── Sim_cluster_LNP.m          # Network definition, parameters, simulation setup
├── LNP_ClusterNet3.c          # C code for numerical integration (compiled as MEX)
├── NNAnalysis.py              # Analysis code for firing rates and modulation indices
├── final_figure.ipynb         # Code to generate model figure in main text
├── SuppFig.ipynb              # Code to generate supplemental figure
│
├── unstruc_no_overlap/
│   ├── left_sound_passive/
│   │   └── *.mat
│   ├── left_sound_active/
│   │   └── *.mat
│   ├── left_stimsound_passive/
│   │   └── *.mat
│   └── left_stimsound_active/
│       └── *.mat
│
├── unstruc_overlap/
│   ├── left_sound_passive/
│   │   └── *.mat
│   ├── left_sound_active/
│   │   └── *.mat
│   ├── left_stimsound_passive/
│   │   └── *.mat
│   └── left_stimsound_active/
│       └── *.mat
│
└── struc_no_overlap/
    ├── left_sound_passive/
    │   └── *.mat
    ├── left_sound_active/
    │   └── *.mat
    ├── left_stimsound_passive/
    │   └── *.mat
    └── left_stimsound_active/
        └── *.mat
```


The repository contains code for network simulation and analysis, along with simulation outputs for multiple network model variants. The directories “unstruc_no_overlap”, “unstruc_overlap”, and “struc_no_overlap” correspond to different model variants - 
1. “unstruc_no_overlap”: unstructured weight matrix, no overlap between photostim and context neurons.
2. “unstruc_overlap”: unstructured weight matrix, overlap allowed between photostim and context neurons.
3. “struc_no_overlap”: structured weight matrix, no overlap allowed between photostim and context neurons.
Each contains subdirectories for the stimulus and context conditions analyzed in the manuscript, which store the raw spike time series (`.mat`) generated by the simulations, as well as simulation parameters. For each input and context, the modulation indices are stored in .txt files. These files are used to generate figures.

## Simulation model

The MATLAB code defines network connectivity, neuronal populations, and external inputs, including stimulus and context conditions. Network dynamics are simulated by calling a C (MEX) function that integrates the equations of motion using a forward Euler scheme.
Spikes are generated stochastically at each time step according to a Poisson process based on a pre-defined transfer function.
Simulation outputs consist of spike time series and corresponding parameter structures saved as .mat files.

## Data analysis
Spike time series are analyzed in Python to compute firing rates and modulation indices. Firing rates are computed in predefined time windows before and after input onset, and modulation indices are derived from these rates as described in the Methods. Derived quantities are saved and used directly to generate the figures in the manuscript.
Reproducing figures
Each figure in the manuscript is generated using a small number of scripts that:
Run the network simulation (MATLAB / C).
Compute firing rates and modulation indices (Python).
Generate plots from derived data (Python).

## Data availability
Sample output files containing spiking times are available for all model variants in the directories “left_sound_passive”, “left_sound_active”, etc. All raw data can be regenerated using the provided simulation scripts. Derived data underlying the figures (firing rates and modulation indices) are included.
Code availability
All code used in this study is available in this repository.
A versioned archive will be made publicly available upon publication.

